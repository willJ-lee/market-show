{"ast":null,"code":"import { reactive, toRefs } from 'vue';\nimport { useRouter } from 'vue-router';\nimport axios from 'axios';\nimport { post } from '../../utils/request.js'; // 引入蒙层函数\n\nimport Toast, { useToastEffect } from '../../components/Toast.vue'; // register部分代码\n\nconst userRegisterEfffect = () => {\n  const router = useRouter();\n\n  const handleRegisterClcik = () => {\n    router.push({\n      name: 'Register'\n    });\n  };\n\n  return {\n    handleRegisterClcik\n  };\n}; // 路由权限跳转 islogin\n\n\nconst useLoginEffect = errMessage => {\n  const data = reactive({\n    username: '',\n    password: ''\n  });\n  const router = useRouter();\n\n  const handlelogin = async () => {\n    try {\n      const result = await post('/vue/login', {\n        username: data.username,\n        password: data.password\n      });\n\n      if (result?.error === 0) {\n        localStorage.isLogin = true;\n        router.push({\n          name: 'Home'\n        });\n      } else {\n        errMessage('登录失败');\n      }\n    } catch (e) {\n      errMessage('请求失败');\n    }\n  };\n\n  const {\n    username,\n    password\n  } = toRefs(data);\n  return {\n    username,\n    password,\n    handlelogin\n  };\n};\n\nexport default {\n  name: 'Login',\n  components: {\n    Toast\n  },\n\n  setup() {\n    // 解构蒙层函数代码\n    const {\n      showToast,\n      toastMessage,\n      errMessage\n    } = useToastEffect();\n    const {\n      username,\n      password,\n      handlelogin\n    } = useLoginEffect(errMessage);\n    const {\n      handleRegisterClcik\n    } = userRegisterEfffect();\n    return {\n      handlelogin,\n      handleRegisterClcik,\n      showToast,\n      toastMessage,\n      username,\n      password\n    };\n  }\n\n};","map":{"version":3,"mappings":"AAoBA,SAASA,QAAT,EAAmBC,MAAnB,QAAiC,KAAjC;AACA,SAASC,SAAT,QAA0B,YAA1B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,wBAArB,C,CACA;;AACA,OAAOC,KAAP,IAAgBC,cAAhB,QAAsC,4BAAtC,C,CAEA;;AACA,MAAMC,mBAAkB,GAAI,MAAM;AAChC,QAAMC,MAAK,GAAIN,SAAS,EAAxB;;AACA,QAAMO,mBAAkB,GAAI,MAAM;AAChCD,UAAM,CAACE,IAAP,CAAY;AAAEC,UAAI,EAAE;AAAR,KAAZ;AACF,GAFA;;AAGA,SAAO;AAAEF;AAAF,GAAP;AACF,CANA,C,CAQA;;;AACA,MAAMG,cAAa,GAAKC,UAAD,IAAgB;AACrC,QAAMC,IAAG,GAAId,QAAQ,CAAC;AACpBe,YAAQ,EAAE,EADU;AAEpBC,YAAQ,EAAE;AAFU,GAAD,CAArB;AAIA,QAAMR,MAAK,GAAIN,SAAS,EAAxB;;AACA,QAAMe,WAAU,GAAI,YAAY;AAC9B,QAAI;AACF,YAAMC,MAAK,GAAI,MAAMd,IAAI,CAAC,YAAD,EAAe;AACtCW,gBAAQ,EAAED,IAAI,CAACC,QADuB;AAEtCC,gBAAQ,EAAEF,IAAI,CAACE;AAFuB,OAAf,CAAzB;;AAIA,UAAIE,MAAM,EAAEC,KAAR,KAAkB,CAAtB,EAAyB;AACvBC,oBAAY,CAACC,OAAb,GAAuB,IAAvB;AACAb,cAAM,CAACE,IAAP,CAAY;AAAEC,cAAI,EAAE;AAAR,SAAZ;AACF,OAHA,MAGO;AACLE,kBAAU,CAAC,MAAD,CAAV;AACF;AACF,KAXA,CAWE,OAAOS,CAAP,EAAU;AACVT,gBAAU,CAAC,MAAD,CAAV;AACF;AACF,GAfA;;AAgBA,QAAM;AAAEE,YAAF;AAAYC;AAAZ,MAAyBf,MAAM,CAACa,IAAD,CAArC;AACA,SAAO;AAAEC,YAAF;AAAYC,YAAZ;AAAsBC;AAAtB,GAAP;AACF,CAxBA;;AA0BA,eAAe;AACbN,MAAI,EAAE,OADO;AAEbY,YAAU,EAAE;AACVlB;AADU,GAFC;;AAKbmB,OAAI,GAAK;AACP;AACA,UAAM;AAAEC,eAAF;AAAaC,kBAAb;AAA2Bb;AAA3B,QAA0CP,cAAc,EAA9D;AACA,UAAM;AAAES,cAAF;AAAYC,cAAZ;AAAsBC;AAAtB,QAAsCL,cAAc,CAACC,UAAD,CAA1D;AACA,UAAM;AAAEJ;AAAF,QAA0BF,mBAAmB,EAAnD;AACA,WAAO;AAAEU,iBAAF;AAAeR,yBAAf;AAAoCgB,eAApC;AAA+CC,kBAA/C;AAA6DX,cAA7D;AAAuEC;AAAvE,KAAP;AACF;;AAXa,CAAf","names":["reactive","toRefs","useRouter","axios","post","Toast","useToastEffect","userRegisterEfffect","router","handleRegisterClcik","push","name","useLoginEffect","errMessage","data","username","password","handlelogin","result","error","localStorage","isLogin","e","components","setup","showToast","toastMessage"],"sourceRoot":"","sources":["/Users/mac/Desktop/jingdong/src/views/login/Login.vue"],"sourcesContent":["<template>\n  <div class=\"wrapper\">\n    <img class=\"wrapper__img\" src=\"http://www.dell-lee.com/imgs/vue3/user.png\">\n    <div class=\"wrapper__input\">\n      <input class=\"wrapper__input__content\" v-model=\"username\" placeholder=\"请输入用户名\"/>\n    </div>\n    <div class=\"wrapper__input\">\n      <input type=\"password\" class=\"wrapper__input__content\"  v-model=\"password\" placeholder=\"请输入密码\" />\n    </div>\n    <div class=\"wrapper__login-button\" @click='handlelogin'>登录</div>\n    <div class=\"wrapper__login-link\">\n      <span class=\"wrapper__login-link-registe\" @click='handleRegisterClcik'>立即注册</span>\n      <span class=\"wrapper__login-link-separate\">|</span>\n      <span class=\"wrapper__login-link-reset\">忘记密码</span>\n    </div>\n  </div>\n  <Toast v-if='showToast' :message='toastMessage' />\n</template>\n\n<script>\nimport { reactive, toRefs } from 'vue'\nimport { useRouter } from 'vue-router'\nimport axios from 'axios'\nimport { post } from '../../utils/request.js'\n// 引入蒙层函数\nimport Toast, { useToastEffect } from '../../components/Toast.vue'\n\n// register部分代码\nconst userRegisterEfffect = () => {\n  const router = useRouter()\n  const handleRegisterClcik = () => {\n    router.push({ name: 'Register' })\n  }\n  return { handleRegisterClcik }\n}\n\n// 路由权限跳转 islogin\nconst useLoginEffect = (errMessage) => {\n  const data = reactive({\n    username: '',\n    password: ''\n  })\n  const router = useRouter()\n  const handlelogin = async () => {\n    try {\n      const result = await post('/vue/login', {\n        username: data.username,\n        password: data.password\n      })\n      if (result?.error === 0) {\n        localStorage.isLogin = true\n        router.push({ name: 'Home' })\n      } else {\n        errMessage('登录失败')\n      }\n    } catch (e) {\n      errMessage('请求失败')\n    }\n  }\n  const { username, password } = toRefs(data)\n  return { username, password, handlelogin }\n}\n\nexport default {\n  name: 'Login',\n  components: {\n    Toast\n  },\n  setup () {\n    // 解构蒙层函数代码\n    const { showToast, toastMessage, errMessage } = useToastEffect()\n    const { username, password, handlelogin } = useLoginEffect(errMessage)\n    const { handleRegisterClcik } = userRegisterEfffect()\n    return { handlelogin, handleRegisterClcik, showToast, toastMessage, username, password }\n  }\n}\n</script>\n\n<style lang='scss' scoped>\n@import '../../style/viriables.scss';\n  .wrapper {\n    position: absolute;\n    top: 50%;\n    left: 0;\n    right: 0;\n    transform: translateY(-50%);\n    &__img {\n      display: block;\n      margin:0 auto .4rem;\n      width: .66rem;\n      height: .66rem\n    }\n    &__input {\n      margin: 0 .4rem .16rem;\n      padding: 0 .16rem;\n      height: .48rem;\n      background: #F9F9F9;\n      border: 1px solid rgba(0,0,0,0.10);\n      border-radius: .06rem;;\n      &__content {\n        width: 100%;\n        line-height: .48rem;\n        border: none;\n        outline: none;\n        font-size: .16rem;\n        background: none;\n        &::placeholder {\n          color: $content-notice-fontcolor;\n        }\n      }\n    }\n    &__login-button {\n      margin: .32rem .4rem .16rem;\n      height: .48rem;\n      box-shadow: 0 .04rem .08rem 0 rgba(0,145,255,0.32);\n      border-radius: .04rem;\n      background: #0091FF;\n      text-align: center;\n      line-height: .48rem;\n      font-size: .16rem;\n      color: #fff;\n    }\n    &__login-link {\n      text-align: center;\n      font-size: .14rem;\n      color: $content-notice-fontcolor;\n      &-separate {\n        margin: 0 .12rem;\n      }\n    }\n  }\n</style>\n"]},"metadata":{},"sourceType":"module"}