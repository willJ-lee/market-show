{"ast":null,"code":"import { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-0de8618f\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"cart\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"product\"\n};\nconst _hoisted_3 = {\n  class: \"product__header\"\n};\nconst _hoisted_4 = {\n  class: \"product__header__all\"\n};\nconst _hoisted_5 = [\"innerHTML\"];\n\nconst _hoisted_6 = /*#__PURE__*/_createTextVNode(\" 全选 \");\n\nconst _hoisted_7 = {\n  class: \"product__header__clear\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"product__item\"\n};\nconst _hoisted_9 = [\"innerHTML\", \"onClick\"];\nconst _hoisted_10 = [\"src\"];\nconst _hoisted_11 = {\n  class: \"product__item__detail\"\n};\nconst _hoisted_12 = {\n  class: \"product__item__title\"\n};\nconst _hoisted_13 = {\n  class: \"product__item__price\"\n};\n\nconst _hoisted_14 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"product__item__yen\"\n}, \"¥\", -1\n/* HOISTED */\n));\n\nconst _hoisted_15 = {\n  class: \"product__item__origin\"\n};\nconst _hoisted_16 = {\n  class: \"product__number\"\n};\nconst _hoisted_17 = [\"onClick\"];\nconst _hoisted_18 = [\"onClick\"];\nconst _hoisted_19 = {\n  class: \"check\"\n};\nconst _hoisted_20 = {\n  class: \"check__icon\"\n};\nconst _hoisted_21 = {\n  class: \"check__icon__tag\"\n};\nconst _hoisted_22 = {\n  class: \"check__info\"\n};\n\nconst _hoisted_23 = /*#__PURE__*/_createTextVNode(\" 总计: \");\n\nconst _hoisted_24 = {\n  class: \"check__info__price\"\n};\n\nconst _hoisted_25 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"check__btn\"\n}, \"去结算\", -1\n/* HOISTED */\n));\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(_Fragment, null, [$setup.showCart ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 0,\n    class: \"mask\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $setup.handleCartShowChange && $setup.handleCartShowChange(...args))\n  })) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_1, [_createCommentVNode(\" 购物车选中商品展示 \"), $setup.showCart ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"span\", {\n    class: \"product__header__icon iconfont\",\n    innerHTML: $setup.allChecked ? '' : '',\n    onClick: _cache[1] || (_cache[1] = () => {\n      $setup.setCartItemSelect($setup.shopId);\n    })\n  }, null, 8\n  /* PROPS */\n  , _hoisted_5), _hoisted_6]), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"span\", {\n    class: \"product__header__clear__btn\",\n    onClick: _cache[2] || (_cache[2] = () => {\n      $setup.cleanCartProducts($setup.shopId);\n    })\n  }, \"清空购物车\")])]), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.productList, item => {\n    return _openBlock(), _createElementBlock(_Fragment, {\n      key: item._id\n    }, [item.count > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [_createElementVNode(\"div\", {\n      class: \"product__item__checked iconfont\",\n      innerHTML: item.check ? '' : '',\n      onClick: () => {\n        $setup.changeCartItemChecked($setup.shopId, item._id);\n      }\n    }, null, 8\n    /* PROPS */\n    , _hoisted_9), _createElementVNode(\"img\", {\n      class: \"product__item__img\",\n      src: item.imgUrl\n    }, null, 8\n    /* PROPS */\n    , _hoisted_10), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"h4\", _hoisted_12, _toDisplayString(item.name), 1\n    /* TEXT */\n    ), _createCommentVNode(\" <p class=\\\"product__item__sales\\\">月售{{item.sales}}件</p> \"), _createElementVNode(\"p\", _hoisted_13, [_hoisted_14, _createTextVNode(_toDisplayString(item.price) + \" \", 1\n    /* TEXT */\n    ), _createElementVNode(\"span\", _hoisted_15, \"¥\" + _toDisplayString(item.oldPrice), 1\n    /* TEXT */\n    )])]), _createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"span\", {\n      class: \"product__number__minus\",\n      onClick: () => {\n        $setup.changeCartItemInfo($setup.shopId, item._id, item, -1);\n      }\n    }, \"-\", 8\n    /* PROPS */\n    , _hoisted_17), _createTextVNode(\" \" + _toDisplayString(item.count || 0) + \" \", 1\n    /* TEXT */\n    ), _createElementVNode(\"span\", {\n      class: \"product__number__plus\",\n      onClick: () => {\n        $setup.changeCartItemInfo($setup.shopId, item._id, item, 1);\n      }\n    }, \"+\", 8\n    /* PROPS */\n    , _hoisted_18)])])) : _createCommentVNode(\"v-if\", true)], 64\n    /* STABLE_FRAGMENT */\n    );\n  }), 128\n  /* KEYED_FRAGMENT */\n  ))])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 购物车底部显示 \"), _createElementVNode(\"div\", _hoisted_19, [_createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"img\", {\n    class: \"check__icon__img\",\n    src: \"http://www.dell-lee.com/imgs/vue3/basket.png\",\n    onClick: _cache[3] || (_cache[3] = (...args) => $setup.handleCartShowChange && $setup.handleCartShowChange(...args))\n  }), _createElementVNode(\"div\", _hoisted_21, _toDisplayString($setup.cartTotal), 1\n  /* TEXT */\n  )]), _createElementVNode(\"div\", _hoisted_22, [_hoisted_23, _createElementVNode(\"span\", _hoisted_24, \"¥ \" + _toDisplayString($setup.cartPrice), 1\n  /* TEXT */\n  )]), _hoisted_25])])], 64\n  /* STABLE_FRAGMENT */\n  );\n}","map":{"version":3,"mappings":"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","names":["class","_createElementVNode","$setup","_createElementBlock","onClick","_createCommentVNode","innerHTML","_Fragment","_renderList","item","_id","count","check","src","imgUrl","_toDisplayString","name","_hoisted_14","price","oldPrice","_hoisted_17","_hoisted_18","_hoisted_25"],"sourceRoot":"","sources":["/Users/mac/Desktop/jingdong/src/views/shop/Cart.vue"],"sourcesContent":["<template>\n  <div class=\"mask\" v-if='showCart' @click=\"handleCartShowChange\"></div>\n  <div class=\"cart\">\n    <!-- 购物车选中商品展示 -->\n    <div class=\"product\" v-if='showCart'>\n      <div class=\"product__header\">\n        <div class=\"product__header__all\">\n          <span class=\"product__header__icon iconfont\" v-html=\"allChecked ? '&#xe618;' : '&#xe6f7;'\" @click=\"() => { setCartItemSelect(shopId) }\"></span>\n          全选\n        </div>\n        <div class=\"product__header__clear\">\n          <span class=\"product__header__clear__btn\" @click=\"() => { cleanCartProducts(shopId) }\">清空购物车</span>\n        </div>\n      </div>\n      <template v-for=\"item in productList\" :key=\"item._id\">\n        <div class=\"product__item\"  v-if=\"item.count > 0\">\n          <div class=\"product__item__checked iconfont\" v-html=\"item.check ? '&#xe618;' : '&#xe6f7;' \" @click=\"() => { changeCartItemChecked(shopId, item._id) }\"></div>\n          <img class=\"product__item__img\" :src=\"item.imgUrl\">\n          <div class=\"product__item__detail\">\n            <h4 class=\"product__item__title\">{{item.name}}</h4>\n            <!-- <p class=\"product__item__sales\">月售{{item.sales}}件</p> -->\n            <p class=\"product__item__price\">\n              <span class=\"product__item__yen\">&yen;</span>{{item.price}}\n              <span class=\"product__item__origin\">&yen;{{item.oldPrice}}</span>\n            </p>\n          </div>\n          <div class=\"product__number\">\n            <span class=\"product__number__minus\" @click=\"() => { changeCartItemInfo(shopId, item._id, item, -1) }\">-</span>\n            {{item.count || 0 }}\n            <span class=\"product__number__plus\" @click=\"() => { changeCartItemInfo(shopId, item._id, item, 1) }\">+</span>\n          </div>\n        </div>\n      </template>\n    </div>\n    <!-- 购物车底部显示 -->\n    <div class=\"check\">\n      <div class=\"check__icon\">\n        <img class=\"check__icon__img\" src=\"http://www.dell-lee.com/imgs/vue3/basket.png\" @click=\"handleCartShowChange\">\n        <div class=\"check__icon__tag\">{{cartTotal}}</div>\n      </div>\n      <div class=\"check__info\">\n        总计: <span class=\"check__info__price\">&yen; {{cartPrice}}</span>\n      </div>\n      <div class=\"check__btn\">去结算</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { computed, defineCustomElement, ref } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { useStore } from 'vuex'\nimport { useCommonCartEffect } from './commonCartEffect.js'\n\n// 购物车操作相关\nconst useCartEffect = (shopId) => {\n  const { changeCartItemInfo } = useCommonCartEffect()\n  const store = useStore()\n  const cartList = store.state.cartList\n\n  // 计算购物车物品数量\n  const cartTotal = computed(() => {\n    const productList = cartList[shopId]\n    let count = 0\n    if (productList) {\n      for (const i in productList) {\n        const produnct = productList[i]\n        count += produnct.count\n      }\n    }\n    return count\n  })\n\n  // 计算购物车物品价格\n  const cartPrice = computed(() => {\n    const productList = cartList[shopId]\n    let price = 0\n    if (productList) {\n      for (const i in productList) {\n        const product = productList[i]\n        if (product.check) {\n          price += (product.count * product.price)\n        }\n      }\n    }\n    return price.toFixed(2)\n  })\n\n  // 获取cartList\n  const productList = computed(() => {\n    const productList = cartList[shopId]\n    return productList\n  })\n\n  // 根据购物车物品是否选中来判断全选状态\n  const allChecked = computed(() => {\n    const productList = cartList[shopId]\n    let checked = true\n    if (productList) {\n      for (const i in productList) {\n        const product = productList[i]\n        if (product.count > 0 && !product.check) {\n          checked = false\n        }\n      }\n    }\n    return checked\n  })\n\n  // 获取购物车内物品是否被选中\n  const changeCartItemChecked = (shopId, productId) => {\n    store.commit('changeCartItemChecked', { shopId, productId })\n  }\n\n  // 全选按钮实现\n  const setCartItemSelect = (shopId) => {\n    store.commit('setCartItemSelect', { shopId })\n  }\n\n  // 清空购物车\n  const cleanCartProducts = (shopId) => {\n    store.commit('cleanCartProducts', { shopId })\n  }\n\n  return { changeCartItemChecked, changeCartItemInfo, cartTotal, cartPrice, productList, cleanCartProducts, allChecked, setCartItemSelect }\n}\n\n// 展示隐藏购物车逻辑\nconst toggleCartEffect = () => {\n  const showCart = ref(false)\n  const handleCartShowChange = () => {\n    showCart.value = !showCart.value\n  }\n  return { showCart, handleCartShowChange }\n}\n\nexport default {\n  name: 'Cart',\n  setup () {\n    const route = useRoute()\n    const shopId = route.params.id\n   \n    const { changeCartItemInfo, cartTotal, cartPrice, productList, changeCartItemChecked, cleanCartProducts, allChecked, setCartItemSelect } = useCartEffect(shopId)\n    return { cartTotal, cartPrice, productList, shopId, changeCartItemInfo, changeCartItemChecked, cleanCartProducts, allChecked, setCartItemSelect, showCart, handleCartShowChange }\n  }\n}\n</script>\n\n<style lang='scss' scoped>\n@import '../../style/viriables.scss';\n@import '../../style/mixins.scss';\n  // 点击购物车弹出蒙层样式\n  .mask {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0,0,0,0.50);\n  }\n  // 购物车样式\n  .cart {\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    // height: .5rem;\n    box-shadow: 0 -1px 1px 0 $content-bgColor;\n    background: $bgColor;\n  }\n  .product {\n    // overflow-y: scroll;\n    overflow-y: scroll;\n    flex: 1;\n    padding: 0 .18rem 0 .16rem;\n    // background: #fff;\n    &__header {\n      display: flex;\n      line-height: .52rem;\n      border-bottom: .01rem solid $content-bgColor;\n      font-size: .14rem;\n      color: $content-fontcolor;\n      &__icon {\n        line-height: .52rem;\n        font-size: .25rem;\n        vertical-align: top;\n        color: $btn-color;\n      }\n      &__clear {\n        flex: 1;\n        text-align: right;\n        &__btn {\n          display: inline-block;\n        }\n      }\n    }\n    &__item {\n      position: relative;\n      display: flex;\n      border-bottom: .01rem solid $content-bgColor;\n      padding: .12rem 0;\n      &__checked {\n        margin-right: .2rem;\n        line-height: .5rem;\n        font-size: .25rem;\n        color: $btn-color;\n      }\n      &__img {\n        margin: 0 .16rem 0 0;\n        width: .68rem;\n        height: .68rem;\n      }\n      &__detail {\n        overflow: hidden;\n      }\n      &__title {\n        margin-bottom: .06rem;\n        font-weight: normal;\n        line-height: .2rem;\n        font-size: .14rem;\n        color: $content-fontcolor;\n        @include ellipsis;\n      }\n      // &__sales {\n      //   margin: .06rem 0;\n      //   line-height: .16rem;\n      //   font-size: .12rem;\n      //   color: $content-fontcolor;\n      // }\n      &__price {\n        line-height: .2rem;\n        font-size: .14rem;\n        color: $highlight-color;\n      }\n      &__yen {\n        font-size: .12rem;\n      }\n      &__origin {\n        margin-left: .06rem;\n        font-size: .12rem;\n        color: $light-fontColor;\n        text-decoration: line-through;\n      }\n      .product__number {\n        position: absolute;\n        right: 0;\n        bottom: .1rem;\n        color: $content-fontcolor;\n        &__minus, &__plus {\n          display: inline-block;\n          width: .2rem;\n          height: .2rem;\n          line-height: .16rem;\n          border-radius: 50%;\n          font-size: .2rem;\n          text-align: center;\n        }\n        &__minus {\n          margin-right: .1rem;\n          border: .01rem solid $medium-fontColor;\n          color: $medium-fontColor;\n        }\n        &__plus {\n          margin-left: .1rem;\n          background: $btn-color;\n          color: $bgColor;\n        }\n      }\n    }\n  }\n\n  // 购物车底部\n  .check {\n    display: flex;\n    height: .5rem;\n    line-height: .5rem;\n    &__icon {\n      position: relative;\n      width: .84rem;\n      line-height: .5rem;\n      &__img {\n        display: block;\n        margin: .12rem auto;\n        width: .28rem;\n        height: .26rem;\n      }\n      &__tag {\n        position: absolute;\n        padding: 0 .01rem;\n        left: .46rem;\n        right: .17rem;\n        top: .03rem;\n        min-width: .2rem;\n        height: .2rem;\n        line-height: .2rem;\n        text-align: center;\n        background: $highlight-color;\n        border-radius: .1rem;\n        transform: scale(.5);\n        transform-origin: left center;\n        color: $bgColor;\n      }\n    }\n    &__info {\n      flex: 1;\n      font-size: .12rem;\n      color: #333;\n      &__price {\n        font-size: .18rem;\n        color: $highlight-color;\n      }\n    }\n    &__btn {\n      width: .98rem;\n      text-align: center;\n      font-size: .14rem;\n      color: $bgColor;\n      background: #4FB0F9;\n    }\n  }\n</style>\n"]},"metadata":{},"sourceType":"module"}