{"ast":null,"code":"import { computed, defineCustomElement } from 'vue';\nimport { useRoute } from 'vue-router';\nimport { useStore } from 'vuex'; // 购物车操作相关\n\nconst useCartEffect = () => {\n  const store = useStore();\n  const route = useRoute();\n  const shopId = route.params.id;\n  const cartList = store.state.cartList; // 计算购物车物品数量\n\n  const cartTotal = computed(() => {\n    const productList = cartList[shopId];\n    let count = 0;\n\n    if (productList) {\n      for (const i in productList) {\n        const produnct = productList[i];\n        count += produnct.count;\n      }\n    }\n\n    return count;\n  }); // 计算购物车物品价格\n\n  const cartPrice = computed(() => {\n    const productList = cartList[shopId];\n    let price = 0;\n\n    if (productList) {\n      for (const i in productList) {\n        const product = productList[i];\n        price = product.count * product.price;\n      }\n    }\n\n    return price.toFixed(2);\n  }); // 获取cartList\n\n  const productList = computed(() => {\n    const productList = cartList[shopId];\n    return productList;\n  });\n  return {\n    cartTotal,\n    cartPrice,\n    productList\n  };\n};\n\nexport default {\n  name: 'Cart',\n\n  setup() {\n    const {\n      cartTotal,\n      cartPrice,\n      productList\n    } = useCartEffect();\n    return {\n      cartTotal,\n      cartPrice,\n      productList\n    };\n  }\n\n};","map":{"version":3,"mappings":"AAkCA,SAASA,QAAT,EAAmBC,mBAAnB,QAA8C,KAA9C;AACA,SAASC,QAAT,QAAyB,YAAzB;AACA,SAASC,QAAT,QAAyB,MAAzB,C,CAEA;;AACA,MAAMC,aAAY,GAAI,MAAM;AAC1B,QAAMC,KAAI,GAAIF,QAAQ,EAAtB;AACA,QAAMG,KAAI,GAAIJ,QAAQ,EAAtB;AACA,QAAMK,MAAK,GAAID,KAAK,CAACE,MAAN,CAAaC,EAA5B;AACA,QAAMC,QAAO,GAAIL,KAAK,CAACM,KAAN,CAAYD,QAA7B,CAJ0B,CAM1B;;AACA,QAAME,SAAQ,GAAIZ,QAAQ,CAAC,MAAM;AAC/B,UAAMa,WAAU,GAAIH,QAAQ,CAACH,MAAD,CAA5B;AACA,QAAIO,KAAI,GAAI,CAAZ;;AACA,QAAID,WAAJ,EAAiB;AACf,WAAK,MAAME,CAAX,IAAgBF,WAAhB,EAA6B;AAC3B,cAAMG,QAAO,GAAIH,WAAW,CAACE,CAAD,CAA5B;AACAD,aAAI,IAAKE,QAAQ,CAACF,KAAlB;AACF;AACF;;AACA,WAAOA,KAAP;AACD,GAVyB,CAA1B,CAP0B,CAmB1B;;AACA,QAAMG,SAAQ,GAAIjB,QAAQ,CAAC,MAAM;AAC/B,UAAMa,WAAU,GAAIH,QAAQ,CAACH,MAAD,CAA5B;AACA,QAAIW,KAAI,GAAI,CAAZ;;AACA,QAAIL,WAAJ,EAAiB;AACf,WAAK,MAAME,CAAX,IAAgBF,WAAhB,EAA6B;AAC3B,cAAMM,OAAM,GAAIN,WAAW,CAACE,CAAD,CAA3B;AACAG,aAAI,GAAKC,OAAO,CAACL,KAAR,GAAgBK,OAAO,CAACD,KAAjC;AACF;AACF;;AACA,WAAOA,KAAK,CAACE,OAAN,CAAc,CAAd,CAAP;AACD,GAVyB,CAA1B,CApB0B,CAgC1B;;AACA,QAAMP,WAAU,GAAIb,QAAQ,CAAC,MAAM;AACjC,UAAMa,WAAU,GAAIH,QAAQ,CAACH,MAAD,CAA5B;AACA,WAAOM,WAAP;AACD,GAH2B,CAA5B;AAKA,SAAO;AAAED,aAAF;AAAaK,aAAb;AAAwBJ;AAAxB,GAAP;AACF,CAvCA;;AAyCA,eAAe;AACbQ,MAAI,EAAE,MADO;;AAEbC,OAAI,GAAK;AACP,UAAM;AAAEV,eAAF;AAAaK,eAAb;AAAwBJ;AAAxB,QAAwCT,aAAa,EAA3D;AACA,WAAO;AAAEQ,eAAF;AAAaK,eAAb;AAAwBJ;AAAxB,KAAP;AACF;;AALa,CAAf","names":["computed","defineCustomElement","useRoute","useStore","useCartEffect","store","route","shopId","params","id","cartList","state","cartTotal","productList","count","i","produnct","cartPrice","price","product","toFixed","name","setup"],"sourceRoot":"","sources":["/Users/mac/Desktop/jingdong/src/views/shop/Cart.vue"],"sourcesContent":["<template>\n  <div class=\"cart\">\n    <div class=\"product\">\n      <div class=\"product__item\" v-for=\"item in list\" :key=\"item._id\">\n        <img class=\"product__item__img\" :src=\"item.imgUrl\">\n        <div class=\"product__item__detail\">\n          <h4 class=\"product__item__title\">{{item.name}}</h4>\n          <p class=\"product__item__sales\">月售{{item.sales}}件</p>\n          <p class=\"product__item__price\">\n            <span class=\"product__item__yen\">&yen;</span>{{item.price}}\n            <span class=\"product__item__origin\">&yen;{{item.oldPrice}}</span>\n          </p>\n        </div>\n        <div class=\"product__number\">\n          <span class=\"product__number__minus\" @click=\"() => { changeCartItemInfo(shopId, item._id, item, -1) }\">-</span>\n          {{cartList?.[shopId]?.[item._id]?.count || 0 }}\n          <span class=\"product__number__plus\" @click=\"() => { changeCartItemInfo(shopId, item._id, item, 1) }\">+</span>\n        </div>\n      </div>\n    </div>\n    <div class=\"check\">\n      <div class=\"check__icon\">\n        <img class=\"check__icon__img\" src=\"http://www.dell-lee.com/imgs/vue3/basket.png\">\n        <div class=\"check__icon__tag\">{{cartTotal}}</div>\n      </div>\n      <div class=\"check__info\">\n        总计: <span class=\"check__info__price\">&yen; {{cartPrice}}</span>\n      </div>\n      <div class=\"check__btn\">去结算</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { computed, defineCustomElement } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { useStore } from 'vuex'\n\n// 购物车操作相关\nconst useCartEffect = () => {\n  const store = useStore()\n  const route = useRoute()\n  const shopId = route.params.id\n  const cartList = store.state.cartList\n\n  // 计算购物车物品数量\n  const cartTotal = computed(() => {\n    const productList = cartList[shopId]\n    let count = 0\n    if (productList) {\n      for (const i in productList) {\n        const produnct = productList[i]\n        count += produnct.count\n      }\n    }\n    return count\n  })\n\n  // 计算购物车物品价格\n  const cartPrice = computed(() => {\n    const productList = cartList[shopId]\n    let price = 0\n    if (productList) {\n      for (const i in productList) {\n        const product = productList[i]\n        price = (product.count * product.price)\n      }\n    }\n    return price.toFixed(2)\n  })\n\n  // 获取cartList\n  const productList = computed(() => {\n    const productList = cartList[shopId]\n    return productList\n  })\n\n  return { cartTotal, cartPrice, productList }\n}\n\nexport default {\n  name: 'Cart',\n  setup () {\n    const { cartTotal, cartPrice, productList } = useCartEffect()\n    return { cartTotal, cartPrice, productList }\n  }\n}\n</script>\n\n<style lang='scss' scoped>\n@import '../../style/viriables.scss';\n\n  .cart {\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    height: .5rem;\n    box-shadow: 0 -1px 1px 0 $content-bgColor;\n  }\n  .check {\n    display: flex;\n    height: .5rem;\n    line-height: .5rem;\n    &__icon {\n      position: relative;\n      width: .84rem;\n      line-height: .5rem;\n      &__img {\n        display: block;\n        margin: .12rem auto;\n        width: .28rem;\n        height: .26rem;\n      }\n      &__tag {\n        position: absolute;\n        padding: 0 .01rem;\n        left: .46rem;\n        right: .17rem;\n        top: .03rem;\n        min-width: .2rem;\n        height: .2rem;\n        line-height: .2rem;\n        text-align: center;\n        background: $highlight-color;\n        border-radius: .1rem;\n        transform: scale(.5);\n        transform-origin: left center;\n        color: $bgColor;\n      }\n    }\n    &__info {\n      flex: 1;\n      font-size: .12rem;\n      color: #333;\n      &__price {\n        font-size: .18rem;\n        color: $highlight-color;\n      }\n    }\n    &__btn {\n      width: .98rem;\n      text-align: center;\n      font-size: .14rem;\n      color: $bgColor;\n      background: #4FB0F9;\n    }\n  }\n</style>\n"]},"metadata":{},"sourceType":"module"}