{"ast":null,"code":"import { reactive, toRefs, ref, watchEffect } from 'vue';\nimport { useRoute } from 'vue-route';\nimport { get } from '../../utils/request.js'; // tab标签常量\n\nconst categories = [{\n  name: '全部商品',\n  tab: 'all'\n}, {\n  name: '秒杀',\n  tab: 'seckill'\n}, {\n  name: '新鲜水果',\n  tab: 'fruit'\n}]; // 根据 tab 切换逻辑\n\nconst useTabEffect = () => {\n  const currentTab = ref(categories[0].tab);\n\n  const handleTabClick = tab => {\n    currentTab.value = tab;\n  };\n\n  return {\n    currentTab,\n    handleTabClick\n  };\n}; // 列表内容相关逻辑\n\n\nconst useCurrentListEffect = currentTab => {\n  const content = reactive({\n    list: []\n  });\n\n  const getContentData = async () => {\n    const result = await get(`/api/shop/${shopId}/products`, {\n      tab\n    });\n\n    if (result?.errno === 0 && result?.data?.length) {\n      content.list = result.data;\n    }\n  };\n\n  const {\n    list\n  } = toRefs(content);\n  return {\n    list,\n    getContentData\n  };\n};\n\nexport default {\n  name: 'Content',\n\n  setup() {\n    const data = reactive({\n      contentList: []\n    });\n    const {\n      currentTab,\n      handleTabClick\n    } = useTabEffect();\n    const {\n      list,\n      getContentData\n    } = useCurrentListEffect(currentTab);\n    getContentData();\n    return {\n      categories,\n      currentTab,\n      list,\n      handleTabClick\n    };\n  }\n\n};","map":{"version":3,"mappings":"AAmCA,SAASA,QAAT,EAAmBC,MAAnB,EAA2BC,GAA3B,EAAgCC,WAAhC,QAAmD,KAAnD;AACA,SAASC,QAAT,QAAyB,WAAzB;AACA,SAASC,GAAT,QAAoB,wBAApB,C,CAEA;;AACA,MAAMC,UAAS,GAAI,CACjB;AAAEC,MAAI,EAAE,MAAR;AAAgBC,KAAG,EAAE;AAArB,CADiB,EAEjB;AAAED,MAAI,EAAE,IAAR;AAAcC,KAAG,EAAE;AAAnB,CAFiB,EAGjB;AAAED,MAAI,EAAE,MAAR;AAAgBC,KAAG,EAAE;AAArB,CAHiB,CAAnB,C,CAKA;;AACA,MAAMC,YAAW,GAAI,MAAM;AACzB,QAAMC,UAAS,GAAIR,GAAG,CAACI,UAAU,CAAC,CAAD,CAAV,CAAcE,GAAf,CAAtB;;AACA,QAAMG,cAAa,GAAKH,GAAD,IAAS;AAC9BE,cAAU,CAACE,KAAX,GAAmBJ,GAAnB;AACF,GAFA;;AAGA,SAAO;AAAEE,cAAF;AAAcC;AAAd,GAAP;AACF,CANA,C,CAOA;;;AACA,MAAME,oBAAmB,GAAKH,UAAD,IAAgB;AAC3C,QAAMI,OAAM,GAAId,QAAQ,CAAC;AAAEe,QAAI,EAAE;AAAR,GAAD,CAAxB;;AACA,QAAMC,cAAa,GAAI,YAAY;AACjC,UAAMC,MAAK,GAAI,MAAMZ,GAAG,CAAE,aAAYa,MAAO,WAArB,EAAiC;AAAEV;AAAF,KAAjC,CAAxB;;AACA,QAAIS,MAAM,EAAEE,KAAR,KAAkB,CAAlB,IAAuBF,MAAM,EAAEG,IAAR,EAAcC,MAAzC,EAAiD;AAC/CP,aAAO,CAACC,IAAR,GAAeE,MAAM,CAACG,IAAtB;AACF;AACF,GALA;;AAMA,QAAM;AAAEL;AAAF,MAAWd,MAAM,CAACa,OAAD,CAAvB;AACA,SAAO;AAAEC,QAAF;AAAQC;AAAR,GAAP;AACF,CAVA;;AAYA,eAAe;AACbT,MAAI,EAAE,SADO;;AAEbe,OAAI,GAAK;AACP,UAAMF,IAAG,GAAIpB,QAAQ,CAAC;AAAEuB,iBAAW,EAAE;AAAf,KAAD,CAArB;AAGA,UAAM;AAAEb,gBAAF;AAAcC;AAAd,QAAiCF,YAAY,EAAnD;AACA,UAAM;AAAEM,UAAF;AAAQC;AAAR,QAA2BH,oBAAoB,CAACH,UAAD,CAArD;AACAM,kBAAc;AACd,WAAO;AAAEV,gBAAF;AAAcI,gBAAd;AAA0BK,UAA1B;AAAgCJ;AAAhC,KAAP;AACF;;AAVa,CAAf","names":["reactive","toRefs","ref","watchEffect","useRoute","get","categories","name","tab","useTabEffect","currentTab","handleTabClick","value","useCurrentListEffect","content","list","getContentData","result","shopId","errno","data","length","setup","contentList"],"sourceRoot":"","sources":["/Users/mac/Desktop/jingdong/src/views/shop/Content.vue"],"sourcesContent":["<template>\n  <div class=\"content\">\n    <div class=\"category\">\n      <ul class=\"category_content\">\n        <li\n          :class=\"{'category__item': true, 'category__item--active': currentTab === item.tab}\"\n          v-for=\"item in categories\" :key='item.name'\n          @click=\"() => handleTabClick(item.tab)\"\n          >\n          {{item.name}}\n        </li>\n      </ul>\n    </div>\n    <div class=\"product\">\n      <div class=\"product__item\" v-for=\"item in contentList\" :key=\"item._id\">\n        <img class=\"product__item__img\" src=\"http://www.dell-lee.com/imgs/vue3/near.png\">\n        <div class=\"product__item__detail\">\n          <h4 class=\"product__item__title\">{{item.name}}</h4>\n          <p class=\"product__item__sales\">月售{{item.sales}}件</p>\n          <p class=\"product__item__price\">\n            <span class=\"product__item__yen\">&yen;</span>{{item.price}}\n            <span class=\"product__item__origin\">&yen;{{item.oldPrice}}</span>\n          </p>\n        </div>\n        <div class=\"product__number\">\n          <span class=\"product__number__minus\">-</span>\n          0\n          <span class=\"product__number__plus\">+</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs, ref, watchEffect } from 'vue'\nimport { useRoute } from 'vue-route'\nimport { get } from '../../utils/request.js'\n\n// tab标签常量\nconst categories = [\n  { name: '全部商品', tab: 'all' },\n  { name: '秒杀', tab: 'seckill' },\n  { name: '新鲜水果', tab: 'fruit' }\n]\n// 根据 tab 切换逻辑\nconst useTabEffect = () => {\n  const currentTab = ref(categories[0].tab)\n  const handleTabClick = (tab) => {\n    currentTab.value = tab\n  }\n  return { currentTab, handleTabClick }\n}\n// 列表内容相关逻辑\nconst useCurrentListEffect = (currentTab) => {\n  const content = reactive({ list: [] })\n  const getContentData = async () => {\n    const result = await get(`/api/shop/${shopId}/products`, { tab })\n    if (result?.errno === 0 && result?.data?.length) {\n      content.list = result.data\n    }\n  }\n  const { list } = toRefs(content)\n  return { list, getContentData }\n}\n\nexport default {\n  name: 'Content',\n  setup () {\n    const data = reactive({ contentList: [] })\n    \n    \n    const { currentTab, handleTabClick } = useTabEffect()\n    const { list, getContentData } = useCurrentListEffect(currentTab)\n    getContentData()\n    return { categories, currentTab, list, handleTabClick }\n  }\n}\n</script>\n\n<style lang='scss' scoped>\n@import '../../style/viriables.scss';\n@import '../../style/mixins.scss';\n\n.content {\n  display: flex;\n  position: absolute;\n  top: 1.52rem;\n  right: 0;\n  bottom: .5rem;\n  left: 0;\n}\n.category {\n  overflow-y: scroll;\n  width: .76rem;\n  height: 100%;\n  background: $search-bgcolor;\n  &__content {\n    height: 100%;\n  }\n  &__item {\n    text-align: center;\n    line-height: .4rem;\n    font-size: .14rem;\n    color: $content-fontcolor;\n    &--active {\n      border-radius: .02rem;\n      background: $bgColor;\n    }\n  }\n}\n.product {\n  // overflow-y: scroll;\n  overflow-y: scroll;\n  flex: 1;\n  padding: 0 .18rem 0 .16rem;\n  &__item {\n    position: relative;\n    display: flex;\n    border-bottom: .01rem solid $content-bgColor;\n      padding: .12rem 0;\n    &__img {\n      margin: 0 .16rem 0 0;\n      width: .68rem;\n      height: .68rem;\n    }\n    &__detail {\n      overflow: hidden;\n    }\n    &__title {\n      font-weight: normal;\n      line-height: .2rem;\n      font-size: .14rem;\n      color: $content-fontcolor;\n      @include ellipsis;\n    }\n    &__sales {\n      margin: .06rem 0;\n      line-height: .16rem;\n      font-size: .12rem;\n      color: $content-fontcolor;\n    }\n    &__price {\n      line-height: .2rem;\n      font-size: .14rem;\n      color: $highlight-color;\n    }\n    &__yen {\n      font-size: .12rem;\n    }\n    &__origin {\n      margin-left: .06rem;\n      font-size: .12rem;\n      color: $light-fontColor;\n      text-decoration: line-through;\n    }\n    .product__number {\n      position: absolute;\n      right: 0;\n      bottom: .1rem;\n      color: $content-fontcolor;\n      &__minus, &__plus {\n        display: inline-block;\n        width: .2rem;\n        height: .2rem;\n        line-height: .16rem;\n        border-radius: 50%;\n        font-size: .2rem;\n        text-align: center;\n      }\n      &__minus {\n        margin-right: .1rem;\n        border: .01rem solid $medium-fontColor;\n        color: $medium-fontColor;\n      }\n      &__plus {\n        margin-left: .1rem;\n        background: $btn-color;\n        color: $bgColor;\n      }\n    }\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}